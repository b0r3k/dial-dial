\chapter{Watson Assistant}\label{chapter-wa}

Jak již bylo napsáno, WA je asistent vyvíjený firmou IBM.
V této kapitole nejdříve uvedeme v sekci~\ref{wa-common} obecné informace
o práci s ním, a pak se v sekci~\ref{wa-inside} pokusíme shrnout zjištěné
informace o vnitřním fungování.
Není jich bohužel příliš mnoho, jedná se o komerční produkt,
a tak podrobnosti nejsou dostupné veřejně.

\section{Obecné informace}\label{wa-common}

\subsection{Popis}

WA je určen především pro firmy, nabízí relativně jednoduché vytvoření
vlastního modelu strojového učení na míru podle vložených trénovacích
dat. Propojením s dalšími službami umí kromě předdefinovaných odpovědí
také vyhledávat v databázi, zavolat vnější API pomocí webhooku a odpověď
z něj využít v konverzaci, nebo v případě nutnosti předat dialog lidskému
pracovníkovi. Je možné ho integrovat do existujících komunikačních platforem
jako je Facebook Messenger, Slack nebo WhatsApp, propojit s telefonní
bránou, či přidat do webové stránky nebo aplikace. Poskytuje také monitorování
úspěšnosti proběhlých dialogů \citep{wa_about}.

Přímo podporuje 13 jazyků včetně
češtiny \citep{wa_languages}, ale nabízí také univerzální model. V případě
jeho zvolení se použije předtrénovaný model chápající základní pravidla
vyskytující se ve většině jazyků, který se dotrénuje na poskytnutých
datech v daném jazyce \citep{wa_universal_model}.

\subsection{Vytvoření asistenta}\label{wa-create}

Každý vytvořený asistent musí mít nějaké \textit{dovednosti (skills)},
což jsou prostředí s definovanými úmysly a entitami, které bude asistent
rozpoznávat. Více dovedností mezi sebou může komunikovat
a řízení dialogu si předávat. Entity mohou být založené buď na rozpoznávání tvarů
konkrétních slov, nebo na rozpoznávání dle vzorce -- například pro české telefonní
číslo bychom mohli definovat vzorec pro devět číslic, volitelně s mezerami.

Každé prostředí musí mít také strukturu dialogu.
WA využívá \textit{stromovou} reprezentaci,
kde sekvenčně kontrolujeme splnění podmínky (detekci úmyslu nebo entity) v
jednotlivých sourozencích. Jakmile v jednom najdeme podmínku splněnou, vybereme
odpověď z něj a pokud nějaké má, zanoříme se do jeho synů.

Podrobnější návod k vytvoření asistenta včetně komplikovanějších
technik podává \citet{akbulut_common_2020}.

\section{Vnitřní fungování}\label{wa-inside}

Nejkomplikovanější a zásadní částí WA je NLU, tedy detekce úmyslů
a entit. Ke konci roku 2020 v tom byl úspěšnější než ostatní podobné
systémy \citep{qi2021benchmarking}. Zde se hodí zmínit,
že citovaný článek je sice vydán pracovníky IBM, ale údajně využili
stejný způsob testování jako \citet{arora-etal-2020-hint3}, takže
srovnání má určitou výpovědní hodnotu.

Jak se vývojářům této úspěšnosti podařilo docílit? Posledním vylepšením
je přidání \textit{AutoML}, což je automatické hledání nejlepších algoritmů,
parametrů a vstupních rysů \citep{noauthor_watson_2020}. Tuto techniku
spolu s aktuálně nejlepšími známými postupy shrnují \citet[duben]{He_2021}.
Zkoušení všech
možných kombinací by trvalo velmi dlouho, proto je pro urychlení
využito \textit{meta-učení} \citep{hospedales2020metalearning}.
Zde to konkrétně znamená, že se jiný model dříve naučil, jak které
kombinace parametrů fungují pro
různá data, a pak na nová data aplikuje kombinace, které dříve dobře
fungovaly pro podobná data.

Dále jsou využity hluboké neuronové sítě, ale v kombinaci s tradičními
metodami strojového učení jako SVM \citep{bosertraining}, což umožňuje
rychlejší trénink i klasifikaci \citep{potdar_watson_2021}. V neposlední
řadě je potřeba zmínit přenosové učení, které využije model předtrénovaný
na velkém množství obecnějších dat, kterému pak stačí pro dobré výsledky
v konkrétní oblasti méně dat speciálních \citep{zhuang2020comprehensive}.

Předtím, než uživatelův vstup vůbec přijde do složitého porozumění jazyku,
je potřeba zbavit se nepřesností, které by klasifikaci výrazně ztížily.
K tomu jsou využity jazykové modely, metody strojového učení a
různé metriky vzdáleností mezi řetězci. Díky tomu WA údajně \uv{porozumí}
okolnímu kontextu a dokáže překlepy a chyby opravovat v závislosti
na něm \citep{mason_ahnouncing_2019}.

\chapter{Konstrukce dialogových systémů}

Krátce shrneme dva
nejběžnější přístupy ke konstrukci. Tradiční je přístup, který bychom
mohli označit jako postupný. Taková konstrukce čítá několik komponent, kde
každá zajišťuje část práce nutné k porozumění uživateli a zodpovězení jeho
prohlášení. Ten uvedeme jako první, neboť dobře ilustruje, co všechno vlastně
člověk podvědomě při komunikaci dělá. Dále uvedeme tzv. \textit{end-to-end}
systémy využívající metod strojového učení, které umožňují nahrazení až
několika komponent jedním modelem. Tento přístup první uvedený v mnohém
předčil, ale je běžnou praxí obě konstrukce kombinovat.

TODO možná terminologie? spíš ne

\section{Tradiční inkrementální systémy}

Již jsme zmínili, že takové systémy mají několik komponent, které na sebe
navazují, jedna obvykle určitým způsobem využije výstup z předchozí jako svůj
vstup.

\subsection{Převod mluvené řeči na text}

Zkráceně značíme nejčastěji \textit{STT} z anglického \textit{speech-to-text}.
Jak název napovídá, úkolem této komponenty je převést zvukový projev na text.
Dříve byly k tomuto účelu využívány především \textit{skryté
    Markovovy modely (hidden Markov models, HMM)}. Tyto modely se nazývají skryté,
protože jejich vnitřní stavy nemohou být pozorovány, vidíme pouze výstup.
Jsou postaveny na \textit{Markovových řetězcích}, jejichž základním předpokladem
je, že v sekvenci stavů pravděpodobnost příštího závisí jen na stavu aktuálním,
nikoliv žádném předchozím, jak uvádí například \citet[strana 4]{brooks_handbook_2011}.
Jejich výhodou je, že jsou poměrně jednoduché a nenáročné na výpočetní výkon.

Jako v mnoha jiných odvětvích, i zde přišly ke slovu neuronové sítě, které HMM
ve většině směrů překonaly. V dobrých podmínkách jsou schopny provést přepis
téměř bezchybně. Opět však narážíme i na jejich slabé stránky,
totiž vysokou náročnost na množství trénovacích dat a výpočetní výkon.

O obecných problémech typu okolního hluku či různé výslovnosti jsme se
již zmiňovali. Zde ještě dodáme, že komplikací může být i nedostatečná kvalita
nahrávky. Mimo jiné z těchto důvodů výstupem často nebývá jen jedno
slovo či věta, nýbrž několik spolu s \textit{jistotou}, kterou model této
variantě přiřadil.

\subsection{Extrakce významu}

Nyní když máme textovou reprezentaci výpovědi, budeme se z ní snažit nějak
jednoduššeji vyjádřit podstatné části. Této komponentě se obvykle říká
\textit{porozumění jazyku (natural language understanding, NLU)}. V jistém
smyslu je její úkol nejnáročnější, neboť jazyky mají mnoho nejasností,
víceznačností a nuancí obecně. Výstupem této komponenty je často opět
seznam reprezentací s hodnotou, nakolik si je systém tou konkrétní
interpretací jistý.

Jako onu jednodušší reprezentaci často používáme trojice
\textit{úmysl}--\textit{slot}--\textit{hodnota}. Pro ilustraci například
úryvek \uv{v deset hodin} bychom mohli přeložit na trojici
informovat--čas--10:00. K získání relevantních trojic můžeme využít ručně
psané \textit{regulární výrazy} vyhledávající vzorce v textu, tento přístup
je však dost náročný. Pro rozumnou funkcionalitu takových výrazů musíme napsat
stovky. Dnes obvykle lepší alternativou jsou opět modely využívající strojové
učení.

\subsection{Zachování stavu}

Od systému samozřejmě budeme vyžadovat určitou paměť. Pokud řekneme, že
chceme někomu zavolat, pak dostaneme otázku komu, a pak ji zodpovíme, očekáváme,
že systém si bude ještě pamatovat, že chceme volat. Tato komponenta je
značena \textit{DST} z anglického \textit{Dialogue State Tracker}. V případě
zmíněné reprezentace pomocí trojic paměti docílíme obvykle tak, že si pro každý
slot pamatujeme hodnotu. Buď jednu, kterou v případě detekce jiné ihned přepíšeme,
nebo si pro každý slot pamatujeme pravděpodobnostní rozložení více hodnot, které
průběžně upravujeme. Téma hezky shrnují Williams, Raux a Handerson ve svém článku
\citep{williams_dialog_2016}. Paměť nesmíme zapomenout v určitých případech
resetovat, například když uživatel změní celý svůj cíl, jím dříve
zmíněné hodnoty se stávají irelevantními.

\subsection{Rozhodnutí o dalším kroku}

Máme uživatelovu aktuální výpověď a relevantní historii dialogu, nyní potřebujeme
rozhodnout, jak zareagujeme. Můžeme ručně napsat pravidla, na základě kterých
se rozhodneme o odpovědi. U systémů zaměřených na plnění úkolů je častou
strategií snaha zjistit uživatelův cíl a následné získání informací potřebných
k tomuto cíli (například pokud máme zarezervovat let, potřebujeme vědět kdy,
odkud a kam), jinými slovy vyplnění potřebných slotů. Rozhodovacích pravidel
však potřebujeme mnoho a zvláště u větších systémů může být výsledný proces dost
zmatený. I zde jsou dnes využívány statistické modely a různé druhy strojového
učení (hodí se zmínit především \textit{zpětnovazebné}). Výstupem této komponenty
bývá opět určitý mezistupeň, jednodušší reprezentace nesoucí význam. Využít
můžeme již zmíněné trojice úmysl--slot--hodnota.

\subsection{Vytvoření odpovědi v přirozeném jazyce}

Z interní reprezentace významu nyní potřebujeme vytvořit odpověď v přirozeném
jazyce, kterou pochopí libovolný uživatel. Můžeme využít \textit{šablon}, do
kterých doplníme vynechané části dle stavu dialogu (například
\uv{Přejete si odlétat [zítra] v [10:00]?}). Přidáním více variant (ze kterých
pak můžeme volit náhodně) pro každou šablonu dosáhneme i určité autentičnosti
dialogu. Opět narážíme na pracnost tohoto přístupu, šablon totiž i pro
jednotlivou doménu musíme vytvořit desítky a více. Přesto mohou posloužit až
překvapivě dobře. Dalšími možnostmi je použít formálních gramatik či i zde
strojového učení.

\subsection{Převod textu na hlas}

Obdobně jako u převodu opačným směrem, značíme \textit{TTS}. Důležitými pojmy
při popisu řeči jsou \textit{fón}, což je v zásadě jakýkoliv zvuk nehledě na
význam; a \textit{foném}, což je nejmenší část jazyka,
pomocí které jsme schopni význam rozlišit. Především jejich analýza pomáhá
při snaze o počítačovou syntézu hlasu.

Důkazem může být například
\textit{konkatenační} přístup ke generování hlasu, kdy nahrajeme mluvu člověka,
nahrávku rozdělíme na \textit{difóny} (dva za sebou jdoucí fóny) a ty pak
zpět \uv{slepíme} v požadovaném pořadí. V této základní variantě dostaneme
hlas, který bude znít značně roboticky (mimo jiné kvůli absenci intonace či
přízvuků), ale uživatel z něj dokáže pochopit význam. Při dostatečném množství
vzorových dat a aplikaci dalších vylepšení však dostáváme již velmi dobré
výsledky.

Mezi další využíváné přístupy patří opět využití HMM nebo strojového učení. Modely
využívající hluboké neuronové sítě jsou již pro některé jazyky téměř
nerozeznatelné od lidského mluvčího, když velmi dobře zvládají výslovnost,
intonaci i důrazy.

\section{End-to-end modely}